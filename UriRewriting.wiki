#summary Helping Minify to correctly rewrite URIs in CSS
#labels Phase-Deploy

Minify uses an algorithm to rewrite relative URIs in CSS output to root-relative URIs so that each link points to the same location it did in its original file.

Say your style sheet `http://example.org/theme/fashion/style.css` contains:
{{{
body { background: url(bg.jpg); }
}}}

When Minify serves this content (from `http://example.org/min/f=theme/fashion/style.css` or `http://example.org/min/g=css`) it re-writes the URI so the image is correctly linked:
{{{
body{background:url(/theme/fashion/bg.jpg)}
}}}

You can see the steps used to rewrite your URIs by enabling [Debugging debug mode].

== Document Root Confusion ==

Out-of-the-box, Minify gets confused when `min` is placed in a subdirectory of the real document root. There's now a [AlternateFileLayouts simple workaround] for this, making `min` more portable.

== Aliases / Symlinks / Virtual Directories ==

Whether you use [http://httpd.apache.org/docs/2.2/mod/mod_alias.html aliases], [http://en.wikipedia.org/wiki/Symbolic_link symlinks], or [http://msdn.microsoft.com/en-us/library/zwk103ab.aspx virtual directories], if you make content outside of the DOC_ROOT available at public URLs, Minify may need manual configuration of the `$min_symlinks` option to rewrite some URIs correctly. Consider this scenario, where `http://example.org/static/style.css` will serve `/etc/static_content/style.css`:
|| document root || `/var/www` ||
|| Apache mod_alias || `Alias /static /etc/static_content` ||
|| ...or symlink || `ln -s /etc/static_content /var/www/static` ||

In `/min/config.php` you'll need the following:
{{{
$min_symlinks = array(
//  URL path   => file path
    '//static' => '/etc/static_content'
);
}}}
This lets Minify know during the rewriting process that an internal file path starting with `/etc/static_content` should be rewritten as a public URI beginning with `/static`.

== It's still not working ==

  # Make sure you have the [http://code.google.com/p/minify/downloads/list latest version].
  # Enable [Debugging debug mode], which will show you the URI transformation process.
  # Check that `$_SERVER['DOCUMENT_ROOT']` is a real directory path. If not, URI rewriting will fail. If you cannot fix this in httpd.conf, etc., use the [http://code.google.com/p/minify/source/browse/trunk/min/config.php?r=292#47 configuration option].
  # Paste your [Debugging debug mode] comment block into a new post on the [http://groups.google.com/group/minify minify mailing list].